<div class="main-content" >
  <div class="container-fluid">
      <div class="row">
          <div class="col-md-12">
              <div class="card">
                  <div class="header">
                      <h4 class="title">Light Bootstrap Table Heading</h4>
                      <p class="category">Created using Roboto Font Family</p>
                  </div>
                  <div class="content">

                    
                      
                      


<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Nom</th>
      <th>Description</th>
      <th>Statut</th>
      <th>Priorité</th>
    
    
      <th>Actions</th>
   
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let tache of displayedTaches; let i = index" (dblclick)="showTaskDetails(tache)"> <!-- Ajouter cette partie -->
      
      <td>{{ tache.id }}</td>
      <td>{{ tache.nom || tache.titre }}</td>
      <td>
        {{ tache.description }}
        <button class="analyze-btn" (click)="analyzeDescription(tache)">
          <i class="fas fa-robot"></i> Analyser
        </button>
      </td>
      <td [attr.data-statut]="tache.statut">{{ tache.statut }}</td>
      <td [attr.data-priorite]="tache.priorite">{{ tache.priorite }}</td>
   
     
      <td><button (click)="generatePDF(tache)" class="icon-button pdf">
        <i class="fas fa-file-pdf"></i>
      </button></td>
    </tr>
  </tbody>
</table>
<div class="pagination">
  <button (click)="goToPreviousPage()" [disabled]="currentPage === 1">
    <i class="fas fa-chevron-left"></i> <!-- Flèche précédente -->
  </button>
  <button (click)="goToNextPage()" [disabled]="currentPage === totalPages">
    <i class="fas fa-chevron-right"></i> <!-- Flèche suivante -->
  </button>
</div>
<!-- Modal de détails -->
<div class="modal-overlay" *ngIf="selectedTache" (click)="closeDetails()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Détails de la tâche</h2>
      <button class="close-btn" (click)="closeDetails()">&times;</button>
    </div>
    
    <div class="modal-body">
      <p><strong>Nom:</strong> {{ selectedTache?.nom || selectedTache?.titre }}</p>
<p><strong>Description:</strong> {{ selectedTache?.description }}</p>
<p><strong>Statut:</strong> {{ selectedTache?.statut }}</p>
<p><strong>Priorité:</strong> {{ selectedTache?.priorite }}</p>

<p><strong>Projet ID:</strong> {{ selectedTache?.projet?.id }}</p>
<p><strong>Responsable ID:</strong> {{ selectedTache?.responsable?.id }}</p>

    </div>
  </div>
</div>
<!-- JavaScript Libraries -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
<script src="lib/easing/easing.min.js"></script>
<script src="lib/wow/wow.min.js"></script>
<script src="lib/owlcarousel/owl.carousel.min.js"></script>
<script src="lib/isotope/isotope.pkgd.min.js"></script>
<script src="lib/lightbox/js/lightbox.min.js"></script>
<script src="lib/waypoints/waypoints.min.js"></script>
<script src="lib/counterup/counterup.min.js"></script>
<script src="lib/slick/slick.min.js"></script>

<!-- Template Javascript -->
<script src="js/main.js"></script>

<style>
.search-container {
  margin: 20px 0;
  position: relative;
}

.search-input-wrapper {
  position: relative;
  width: 100%;
  max-width: 500px;
  margin: 0 auto;
}

.search-input {
  width: 100%;
  padding: 12px 40px 12px 40px;
  border: 2px solid #ddd;
  border-radius: 25px;
  font-size: 16px;
  transition: all 0.3s ease;
}

.search-input:focus {
  border-color: #007bff;
  box-shadow: 0 0 0 3px rgba(0,123,255,0.25);
  outline: none;
}

.search-icon {
  position: absolute;
  left: 15px;
  top: 50%;
  transform: translateY(-50%);
  color: #666;
}

.search-spinner {
  position: absolute;
  right: 15px;
  top: 50%;
  transform: translateY(-50%);
  color: #007bff;
}

.search-status {
  text-align: center;
  margin-top: 20px;
  color: #666;
}

.icon-button {
  background: none;
  border: none;
  padding: 5px;
  cursor: pointer;
  transition: all 0.3s ease;
  margin: 0 3px;
}

.icon-button:hover {
  transform: translateY(-2px);
}

.icon-button.delete:hover {
  color: #dc3545;
}

.icon-button.pdf {
  color: #e74c3c;
}

.icon-button.pdf:hover {
  color: #c0392b;
}

@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

.icon-button.pdf:active {
  animation: pulse 0.3s ease-in-out;
}
</style>

<div class="analysis-results" *ngIf="taskAnalysis">
<h3>Analyse de la tâche</h3>

<!-- Étapes détectées -->
<div class="analysis-section">
  <h4>Étapes détectées ({{ taskAnalysis.steps.length }})</h4>
  <ul class="steps-list">
    <li *ngFor="let step of taskAnalysis.steps">
      {{ step }}
    </li>
  </ul>
  <p *ngIf="taskAnalysis.steps.length === 0">
    Aucune étape détectée. Essayez d'utiliser des marqueurs comme "1.", "-", ou "étape".
  </p>
</div>

<!-- Complexité et durée -->
<div class="analysis-section">
  <h4>Évaluation</h4>
  
  <p class="duration">
    Durée estimée: {{ taskAnalysis.estimatedDuration }} heures
  </p>
</div>

<!-- Mots-clés techniques -->
<div class="analysis-section">
  <h4>Mots-clés techniques détectés</h4>
  <div class="keywords">
    <span class="keyword" *ngFor="let keyword of taskAnalysis.keywords">
      {{ keyword }}
    </span>
  </div>
</div>

<!-- Suggestions -->
<div class="analysis-section">
  <h4>Suggestions</h4>
  <ul class="suggestions-list">
    <li *ngFor="let suggestion of taskAnalysis.suggestions">
      {{ suggestion }}
    </li>
  </ul>
</div>
</div>

<style>
.task-analysis-container {
margin: 20px;
padding: 20px;
border-radius: 8px;
background-color: #f8f9fa;
}

.analyze-btn {
background-color: #6c757d;
color: white;
border: none;
padding: 4px 8px;
border-radius: 4px;
cursor: pointer;
font-size: 0.8em;
margin-left: 8px;
display: inline-flex;
align-items: center;
gap: 4px;
}

.analyze-btn:hover {
background-color: #5a6268;
}

.analysis-results {
margin: 20px;
padding: 20px;
border: 1px solid #dee2e6;
border-radius: 8px;
background-color: white;
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.analysis-section {
margin-bottom: 20px;
}

.analysis-section h4 {
color: #495057;
margin-bottom: 10px;
}

.steps-list {
list-style-type: none;
padding-left: 0;
}

.steps-list li {
padding: 8px;
margin-bottom: 5px;
background-color: #f8f9fa;
border-radius: 4px;
}

.complexity {
font-weight: bold;
}

.complexity span {
padding: 3px 8px;
border-radius: 4px;
}

.complexity .simple { background-color: #28a745; color: white; }
.complexity .moyenne { background-color: #ffc107; color: black; }
.complexity .complexe { background-color: #dc3545; color: white; }

.keywords {
display: flex;
flex-wrap: wrap;
gap: 8px;
}

.keyword {
background-color: #e9ecef;
padding: 4px 8px;
border-radius: 4px;
font-size: 0.9em;
}

.suggestions-list {
list-style-type: none;
padding-left: 0;
}

.suggestions-list li {
padding: 8px;
margin-bottom: 5px;
border-left: 3px solid #007bff;
background-color: #f8f9fa;
}
</style>

<!-- Ajouter un modal pour l'analyse -->
<div class="modal-overlay" *ngIf="taskAnalysis" (click)="closeAnalysis()">
<div class="modal-content" (click)="$event.stopPropagation()">
  <div class="modal-header">
    <h3>Analyse de la Tâche</h3>
    <button class="close-btn" (click)="closeAnalysis()">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <div class="modal-body">
    <!-- Résumé rapide -->
    <div class="quick-summary">
      <div class="summary-item">
        <i class="fas fa-list"></i>
        <span>{{ taskAnalysis.steps.length }} étapes</span>
      </div>
      <div class="summary-item">
        <i class="fas fa-clock"></i>
        <span>{{ taskAnalysis.estimatedDuration }}h estimées</span>
      </div>
      <div class="summary-item">
        <i class="fas fa-chart-line"></i>
        
      </div>
    </div>

    <!-- Étapes détectées -->
    <div class="analysis-section">
      <h4><i class="fas fa-tasks"></i> Étapes détectées</h4>
      <div class="steps-container">
        <div class="step-item" *ngFor="let step of taskAnalysis.steps; let i = index">
          <span class="step-number">{{ i + 1 }}</span>
          <span class="step-text">{{ step }}</span>
        </div>
        <p *ngIf="taskAnalysis.steps.length === 0" class="no-steps">
          <i class="fas fa-info-circle"></i>
          Aucune étape détectée. Essayez d'utiliser des marqueurs comme "1.", "-", ou "étape".
        </p>
      </div>
    </div>

    <!-- Mots-clés techniques -->
    <div class="analysis-section">
      <h4><i class="fas fa-tags"></i> Mots-clés techniques</h4>
      <div class="keywords-container">
        <span class="keyword-tag" *ngFor="let keyword of taskAnalysis.keywords">
          <i class="fas fa-code"></i> {{ keyword }}
        </span>
        <p *ngIf="taskAnalysis.keywords.length === 0" class="no-keywords">
          Aucun mot-clé technique détecté
        </p>
      </div>
    </div>

    <!-- Suggestions -->
    <div class="analysis-section">
      <h4><i class="fas fa-lightbulb"></i> Suggestions</h4>
      <div class="suggestions-container">
        <div class="suggestion-item" *ngFor="let suggestion of taskAnalysis.suggestions">
          {{ suggestion }}
        </div>
      </div>
    </div>
  </div>
</div>
</div>

<style>
/* Styles pour le modal */
.modal-overlay {
position: fixed;
top: 0;
left: 0;
right: 0;
bottom: 0;
background-color: rgba(0, 0, 0, 0.5);
display: flex;
justify-content: center;
align-items: center;
z-index: 1000;
}

.modal-content {
background: white;
border-radius: 8px;
width: 90%;
max-width: 800px;
max-height: 90vh;
overflow-y: auto;
box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

.modal-header {
display: flex;
justify-content: space-between;
align-items: center;
padding: 20px;
border-bottom: 1px solid #eee;
}

.modal-header h3 {
margin: 0;
color: #2c3e50;
}

.close-btn {
background: none;
border: none;
font-size: 1.5em;
cursor: pointer;
color: #666;
}

.modal-body {
padding: 20px;
}

/* Résumé rapide */
.quick-summary {
display: flex;
justify-content: space-around;
padding: 20px;
background: #f8f9fa;
border-radius: 8px;
margin-bottom: 20px;
}

.summary-item {
display: flex;
align-items: center;
gap: 10px;
}

.complexity-badge {
padding: 4px 12px;
border-radius: 20px;
font-weight: 500;
}

.simple { background-color: #28a745; color: white; }
.moyenne { background-color: #ffc107; color: black; }
.complexe { background-color: #dc3545; color: white; }

/* Sections d'analyse */
.analysis-section {
margin-bottom: 30px;
}

.analysis-section h4 {
display: flex;
align-items: center;
gap: 10px;
color: #2c3e50;
margin-bottom: 15px;
}

/* Étapes */
.steps-container {
display: flex;
flex-direction: column;
gap: 10px;
}

.step-item {
display: flex;
align-items: center;
gap: 15px;
padding: 10px;
background: #f8f9fa;
border-radius: 6px;
transition: transform 0.2s;
}

.step-item:hover {
transform: translateX(5px);
}

.step-number {
background: #007bff;
color: white;
width: 24px;
height: 24px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-weight: bold;
}

/* Mots-clés */
.keywords-container {
display: flex;
flex-wrap: wrap;
gap: 10px;
}

.keyword-tag {
background: #e9ecef;
padding: 6px 12px;
border-radius: 20px;
display: flex;
align-items: center;
gap: 6px;
font-size: 0.9em;
}

/* Suggestions */
.suggestions-container {
display: flex;
flex-direction: column;
gap: 10px;
}

.suggestion-item {
padding: 10px 15px;
background: #f8f9fa;
border-left: 4px solid #007bff;
border-radius: 4px;
}

/* Messages d'absence de données */
.no-steps, .no-keywords {
color: #6c757d;
font-style: italic;
display: flex;
align-items: center;
gap: 8px;
}
</style>

